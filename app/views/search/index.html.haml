%table.tbl-content.search-page
  = render :partial => "/twocol_top"
  %tr
    %td.lcol{:colspan => 2}
      .column 
        .current_search
          %h4 
            Current Search
          %label Keywords:
          %ul.keywords
            - @keywords.each_with_index do |k, idx|
              %li #{ "AND " if idx > 0} #{k}
          - if @mediums && !@mediums.empty?            
            %label Mediums:
            %ul.media
              - @mediums.map(&:name).each do |n|
                %li #{n}
          - if @studios && !@studios.empty?
            %label Studios:
            %ul.media
              - @studios.map(&:name).each do |n|
                %li #{n}

        .refine_controls 
          %h4 Narrow Your Results
          - form_tag({}, :class=>'power_search') do
            %h5.block_head Add Keyword(s):
            .block
              = text_field_tag :keywords
              = submit_tag :go
            %h5.block_head.expandable_head Mediums:
            .block.expandable
              .cb_entry
                = check_box_tag 'medium', 0
                = label_tag 'Any'
              - Medium.all.map{ |med| {:id => med.id, :name => med.name.to_param, :display => med.name}}.each do |m|
                .cb_entry
                  = check_box_tag 'medium[]', m[:id]
                  = label_tag m[:name], m[:display]
            %h5.block_head.expandable_head Studios:
            .block.expandable
              .cb_entry
                = check_box_tag 'studio', 0
                = label_tag 'Any'
              - Studio.all.map{ |m| {:id => m.id, :name => m.name.to_param, :display => m.name}}.each do |m|
                .cb_entry
                  = check_box_tag 'studio', m[:id]
                  = label_tag m[:name], m[:display]
            %h5.block_head Open Studios Artist:
            .block
              = select_tag :os_artist, options_for_select([["Don't Care", nil], ['Yes', 1], ['No', 2]])
    %td.vstripe
    %td.rcol{:colspan => 2}
      = render :partial => '/flash_notice_error'
      .content-block
        %h4 Search Results - #{@user_query}
        #search_results
          - if @pieces.length <= 0
            = render :partial => 'empty_search_results'
          - else
            .results-txt
              The following #{"artist" + (@pieces.length > 1 ? "s" : '')} matched your query
            .search-view-ctrls
              = render :partial => "/pagination"
            #thumbs_by_artist.search-results
              = render :partial => "thumbs", :locals => { :pieces => @pieces, :params => { :cols => 2, :art_link => true }}	
            .search-view-ctrls
              = render :partial => "/pagination"
  = render :partial => "/twocol_bottom"
