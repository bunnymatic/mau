#admin_nav
  .container#admin_nav_body
    .tab#admin_nav_tab 
      %a{:href => "#", :class => 'lkdark'} 
        admin 
        %span.arrow &#709;
    :ruby
      manager_links = [[:dashboard, {:link => '/admin'}],
                       [:studios , {}]]
      editor_links = [[:dashboard, {:link => '/admin'}],
                      [:cms_documents , {:display => 'cms', :link => '/cms_documents'}],
                      [:featured_artist , {}]]
      usage_links = [[:dashboard, {:link => '/admin'}],
                     [:artists , {}],
                     [:studios , {}],
                     [:cms_documents , {:display => 'cms', :link => '/cms_documents'}],
                     [:emaillist , {:display => 'emails'}],
                     [:os_status , {}]
                    ]
      pr_links = [[:events , {}],
                  [:featured_artist , {}],
                  [:favorites , {}],
                  [:catalog, {:link => '/catalog'}]
                 ]
      model_links = [[:fans , {}],
                     [:artist_feeds , {:display => 'feeds', :link => '/artist_feeds'}],
                     [:media , {}],
                     [:roles , {:link => '/roles'}],
                     [:art_piece_tags , {:display => 'tags'}]
                    ]
      admin_links = [[:app_events, {:display => 'app events', :link => '/application_events'}],
                     [:internal_email , {:display => 'internal messaging', :link => '/email_lists' }],
                     [:db_backups , {:display => 'backups'}],
                     [:palette , {:display => 'colors'}],

                     [:tests , {:link => '/tests'}]
                    ]
      links = []
      if current_user.is_admin?
        links =[ [:usage, usage_links],
          [:pr, pr_links],
          [:lists, model_links],
          [:admin, admin_links] ]
      else 
        links << [ :editor, editor_links ] if current_user.is_editor?
        links << [ :manager, manager_links ] if current_user.is_manager?
      end
       

      links.each do |sxn, entries|
        entries.each do |key, entry|
          entry[:display] = entry[:display] || key.to_s
          entry[:link] = entry[:link] || ("/admin/%s" % key)
        end
      end             
    - links.each do |sxn, entries|
      %div{:class => 'link_section'}
        %span.title #{sxn}
        - entries.each do |key, opts|
          %span.admin-lk
            = link_to opts[:display], opts[:link], {:class => 'lkdark'}
    .clear