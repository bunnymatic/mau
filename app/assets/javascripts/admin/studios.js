// Generated by CoffeeScript 1.12.7
(function() {
  $(function() {
    if ($(".admin.studios").length) {
      return $("#js-studio-arranger tbody").sortable({
        cursor: "move",
        start: function(event, ui) {},
        update: function(event, ui) {
          var ajaxOpts, studioIds;
          studioIds = _.map(
            $(ui.item.context)
              .closest("tbody")
              .find("tr"),
            function(row) {
              return $(row).data("studioId");
            }
          );
          ajaxOpts = {
            url: "/admin/studios/reorder",
            method: "POST",
            data: {
              studios: studioIds
            }
          };
          return $
            .ajax(ajaxOpts)
            .done(function(data) {
              return new MAU.Flash().show({
                notice: "Studio Order has been updated",
                timeout: 2000
              });
            })
            .fail(function(data) {
              new MAU.Flash().show({
                error: "There was trouble updating the studio order"
              });
              return $(ui.sender).sortable("cancel");
            });
        }
      });
    }
  });
}.call(this));
